// Generated by IcedCoffeeScript 108.0.12
(function() {
  var Attest, Base, React, constants, json_stringify_sorted, make_esc, pgp_utils, schema, streq_secure, unix_time, _ref,
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

  Base = require('./base').Base;

  constants = require('./constants').constants;

  make_esc = require('iced-error').make_esc;

  pgp_utils = require('pgp-utils');

  _ref = pgp_utils.util, json_stringify_sorted = _ref.json_stringify_sorted, unix_time = _ref.unix_time, streq_secure = _ref.streq_secure;

  schema = require('./schema3');

  exports.Attest = Attest = (function(_super) {
    __extends(Attest, _super);

    function Attest(obj) {
      this.wot = obj.wot;
      Attest.__super__.constructor.call(this, obj);
    }

    Attest.prototype._v_stub_paths = function() {
      return ["body.wot_attest"];
    };

    Attest.prototype._type = function() {
      return constants.sig_types.wot.attest;
    };

    Attest.prototype._type_v2 = function(revoke_flag) {
      if ((this.revoke != null) || revoke_flag) {
        return constants.sig_types_v2.wot.attest_with_revoke;
      } else {
        return constants.sig_types_v2.wot.attest;
      }
    };

    Attest.prototype._v_check = function(_arg, cb) {
      var json, obj, proof_schema, schm;
      json = _arg.json;
      obj = json.body.wot_attest;
      proof_schema = schema.dict({
        check_data_json: schema.or([
          schema.dict({
            name: schema.string(),
            username: schema.string()
          }), schema.dict({
            domain: schema.string(),
            protocol: schema.string()
          })
        ]),
        state: schema.int(),
        proof_type: schema.int()
      });
      schm = schema.dict({
        user: schema.dict({
          username: schema.string(),
          uid: schema.uid().convert(),
          eldest: schema.dict({
            seqno: schema.int(),
            kid: schema.kid().convert()
          }),
          seq_tail: schema.dict({
            seqno: schema.int(),
            sig_id: schema.sig_id().convert(),
            payload_hash: schema.hash().convert()
          })
        }),
        confidence: schema.dict({
          proofs: schema.array(proof_schema).optional(),
          vouched_by: schema.array(schema.uid().convert()).optional(),
          username_verified_via: schema.string_enum(["audio", "video", "email", "other_chat", "in_person"]).optional(),
          other: schema.string().optional(),
          known_on_keybase_days: schema.int().optional()
        }),
        failing_proofs: schema.array(proof_schema).optional(),
        attestation: schema.array(schema.string())
      });
      return cb(schm.check(obj));
    };

    Attest.prototype._v_customize_json = function(ret) {
      var t;
      if ((t = this.wot.attest) != null) {
        return ret.body.wot_attest = t;
      }
    };

    return Attest;

  })(Base);

  exports.React = React = (function(_super) {
    __extends(React, _super);

    function React(obj) {
      this.wot = obj.wot;
      React.__super__.constructor.call(this, obj);
    }

    React.prototype._v_stub_paths = function() {
      return ["body.wot_react"];
    };

    React.prototype._type = function() {
      return constants.sig_types.wot.react;
    };

    React.prototype._type_v2 = function(revoke_flag) {
      return constants.sig_types_v2.wot.react;
    };

    React.prototype._v_check = function(_arg, cb) {
      var json, obj, schm;
      json = _arg.json;
      obj = json.body.wot_react;
      schm = schema.dict({
        sig_id: schema.sig_id().convert(),
        reaction: schema.string_enum(["accept", "reject"])
      });
      return cb(schm.check(obj));
    };

    React.prototype._v_customize_json = function(ret) {
      var t;
      if ((t = this.wot.react) != null) {
        return ret.body.wot_react = t;
      }
    };

    return React;

  })(Base);

}).call(this);
